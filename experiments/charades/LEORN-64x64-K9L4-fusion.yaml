WORKERS: 16

MODEL_DIR: ./checkpoints
RESULT_DIR: ./results
LOG_DIR: ./log
DATA_DIR: ./data/Charades-STA
TENSORBOARD_DIR: ./tensorboard

DATASET:
  NAME: Charades_RCNN_I3D
  VIS_INPUT_TYPE: i3d
  NO_VAL: False
  NUM_SAMPLE_CLIPS: 256
  TARGET_STRIDE: 4
  NORMALIZE: True
  RANDOM_SAMPLING: False
  OBJECT_NUM: 18

TEST:
  BATCH_SIZE: 16
  RECALL: 1,5
  TIOU: 0.5,0.7
  EVAL_TRAIN: False
  NMS_THRESH: 0.5

CUDNN:
  DETERMINISTIC: False
  BENCHMARK: True

TRAIN:
  BATCH_SIZE: 16
  LR: 0.0001
  WEIGHT_DECAY: 0.0000
  MAX_EPOCH: 20
  STEP_ACCUMULATE: 1
  CONTINUE: False
  FP16: False
  FINE_TUNE: True

LOSS:
  NAME: bce_rescale_loss
  PARAMS:
    MIN_IOU: 0.5
    MAX_IOU: 1.0
    BIAS: 0.0

TAN:
  TEXTUAL_MODULE:
    NAME: MultiAttTextEncoding
    PARAMS:
      TXT_INPUT_SIZE: 300
      TXT_HIDDEN_SIZE: 512
      SEMANTIC_NUM: 1
      RNN:
        NUM_LAYERS: 3
        BIDIRECTIONAL: True

  OBJECT_MODULE:
    NAME: ObjectTextInteraction
    PARAMS:
      OBJECT_INPUT_SIZE: 2048
      VIS_INPUT_SIZE: 4096
      OBJECT_NUM: 36
      HIDDEN_SIZE: 512
      LAYER_NUM: 3
      TEMPORAL_SHIFT: 2
      BBOX_ENCODE: True
      NORM: bn
      TEMPORAL_CONV: 0
      SENTINEL_VECTOR: True
      FRAME_AS_SENTINEL: False
      SHIFT_SENTINEL_VECTOR: True

  FRAME_MODULE:
    NAME: MultiFeatureAvgPool
    PARAMS:
      INPUT_SIZE: 1024
      HIDDEN_SIZE: 512
      KERNEL_SIZE: 4
      STRIDE: 4

  PROP_MODULE:
    NAME: SparsePropMaxPool
    PARAMS:
      HIDDEN_SIZE: 512
      NUM_SCALE_LAYERS: [16,8,8]

  FUSION_MODULE:
    NAME: EasyFusion
    PARAMS:
      HIDDEN_SIZE: 512
      TXT_INPUT_SIZE: 300
      TXT_HIDDEN_SIZE: 512

  MAP_MODULE:
    NAME: ResMapConv
    PARAMS:
      INPUT_SIZE: 512
      NORM: True
      HIDDEN_SIZES: [ 512, 512, 512, 512]
      KERNEL_SIZES: [ 9, 9, 9, 9]
      STRIDES: [ 1, 1, 1, 1]
      PADDINGS: [ 4, 4, 4, 4]
      DILATIONS: [ 1, 1, 1, 1]


  PRED_INPUT_SIZE: 512

MODEL:
  NAME: LEORN_F
